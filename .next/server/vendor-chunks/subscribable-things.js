/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/subscribable-things";
exports.ids = ["vendor-chunks/subscribable-things"];
exports.modules = {

/***/ "(ssr)/./node_modules/subscribable-things/build/es5/bundle.js":
/*!**************************************************************!*\
  !*** ./node_modules/subscribable-things/build/es5/bundle.js ***!
  \**************************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("(function (global, factory) {\n     true ? factory(exports, __webpack_require__(/*! rxjs-interop */ \"(ssr)/./node_modules/rxjs-interop/dist/cjs/index.js\"), __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"(ssr)/./node_modules/@babel/runtime/helpers/defineProperty.js\")) :\n    0;\n})(this, (function (exports, rxjsInterop, _defineProperty) { 'use strict';\n\n    var createAnimationFrame = function createAnimationFrame(emitNotSupportedError, window, wrapSubscribeFunction) {\n      return function () {\n        return wrapSubscribeFunction(function (observer) {\n          if (window === null || window.cancelAnimationFrame === undefined || window.requestAnimationFrame === undefined) {\n            return emitNotSupportedError(observer);\n          }\n          var animationFrameHandle = window.requestAnimationFrame(function animationFrameCallback(timestamp) {\n            animationFrameHandle = window.requestAnimationFrame(animationFrameCallback);\n            observer.next(timestamp);\n          });\n          return function () {\n            return window.cancelAnimationFrame(animationFrameHandle);\n          };\n        });\n      };\n    };\n\n    var createAttribute = function createAttribute(mapSubscribableThing, mutations, prependSubscribableThing) {\n      return function (htmlElement, name) {\n        var getAttribute = function getAttribute() {\n          return htmlElement.getAttribute(name);\n        };\n        return prependSubscribableThing(mapSubscribableThing(mutations(htmlElement, {\n          attributeFilter: [name],\n          childList: false,\n          subtree: false\n        }), function () {\n          return getAttribute();\n        }), getAttribute());\n      };\n    };\n\n    var createGeolocation = function createGeolocation(emitNotSupportedError, window, wrapSubscribeFunction) {\n      return function (options) {\n        return wrapSubscribeFunction(function (observer) {\n          if (window === null || window.navigator === undefined || window.navigator.geolocation === undefined || window.navigator.geolocation.clearWatch === undefined || window.navigator.geolocation.watchPosition === undefined) {\n            return emitNotSupportedError(observer);\n          }\n          var watchId = window.navigator.geolocation.watchPosition(function (position) {\n            return observer.next(position);\n          }, function (err) {\n            return observer.error(err);\n          }, options);\n          return function () {\n            return window.navigator.geolocation.clearWatch(watchId);\n          };\n        });\n      };\n    };\n\n    var createIntersections = function createIntersections(emitNotSupportedError, window, wrapSubscribeFunction) {\n      return function (htmlElement, options) {\n        return wrapSubscribeFunction(function (observer) {\n          if (window === null || window.IntersectionObserver === undefined) {\n            return emitNotSupportedError(observer);\n          }\n          var intersectionObserverObserver = new window.IntersectionObserver(function (entries) {\n            return observer.next(entries);\n          }, options);\n          try {\n            intersectionObserverObserver.observe(htmlElement);\n          } catch (err) {\n            observer.error(err);\n          }\n          return function () {\n            return intersectionObserverObserver.disconnect();\n          };\n        });\n      };\n    };\n\n    function ownKeys$1(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\n    function _objectSpread$1(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys$1(Object(t), true).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys$1(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\n    var createMapSubscribableThing = function createMapSubscribableThing(wrapSubscribeFunction) {\n      return function (subscribableThing, map) {\n        return wrapSubscribeFunction(function (observer) {\n          return subscribableThing(_objectSpread$1(_objectSpread$1({}, observer), {}, {\n            next: function next(value) {\n              return observer.next(map(value));\n            }\n          }));\n        });\n      };\n    };\n\n    var createMediaDevices = function createMediaDevices(emitNotSupportedError, window, wrapSubscribeFunction) {\n      return function () {\n        return wrapSubscribeFunction(function (observer) {\n          if (window === null || window.navigator === undefined || window.navigator.mediaDevices === undefined || window.navigator.mediaDevices.enumerateDevices === undefined) {\n            return emitNotSupportedError(observer);\n          }\n          var isActive = true;\n          var enumerateDevices = function enumerateDevices() {\n            window.navigator.mediaDevices.enumerateDevices().then(function (mediaDevices) {\n              if (isActive) {\n                observer.next(mediaDevices);\n              }\n            }, function (err) {\n              if (isActive) {\n                unsubscribe();\n                observer.error(err);\n              }\n            });\n          };\n          var unsubscribe = function unsubscribe() {\n            isActive = false;\n            window.navigator.mediaDevices.removeEventListener('devicechange', enumerateDevices);\n          };\n          enumerateDevices();\n          window.navigator.mediaDevices.addEventListener('devicechange', enumerateDevices);\n          return unsubscribe;\n        });\n      };\n    };\n\n    var createMediaQueryMatch = function createMediaQueryMatch(emitNotSupportedError, window, wrapSubscribeFunction) {\n      return function (mediaQueryString) {\n        return wrapSubscribeFunction(function (observer) {\n          if (window === null || window.matchMedia === undefined) {\n            return emitNotSupportedError(observer);\n          }\n          var mediaQueryList = window.matchMedia(mediaQueryString);\n          observer.next(mediaQueryList.matches);\n          mediaQueryList.onchange = function () {\n            return observer.next(mediaQueryList.matches);\n          };\n          return function () {\n            mediaQueryList.onchange = null;\n          };\n        });\n      };\n    };\n\n    var createMetrics = function createMetrics(emitNotSupportedError, window, wrapSubscribeFunction) {\n      return function (options) {\n        return wrapSubscribeFunction(function (observer) {\n          if (window === null || window.PerformanceObserver === undefined) {\n            return emitNotSupportedError(observer);\n          }\n          var performanceObserver = new window.PerformanceObserver(function (entryList) {\n            return observer.next(entryList.getEntries());\n          });\n          try {\n            performanceObserver.observe(options);\n          } catch (err) {\n            observer.error(err);\n          }\n          return function () {\n            return performanceObserver.disconnect();\n          };\n        });\n      };\n    };\n\n    var createMidiInputs = function createMidiInputs(wrapSubscribeFunction) {\n      return function (midiAccess) {\n        return wrapSubscribeFunction(function (observer) {\n          var midiInputs = Array.from(midiAccess.inputs.values());\n          var emitMidiInputs = function emitMidiInputs() {\n            var midiAccessInputs = midiAccess.inputs;\n            if (midiInputs.length !== midiAccessInputs.size || midiInputs.some(function (_ref) {\n              var id = _ref.id;\n              return !midiAccessInputs.has(id);\n            })) {\n              midiInputs = Array.from(midiAccessInputs.values());\n              observer.next(midiInputs);\n            }\n          };\n          observer.next(midiInputs);\n          midiAccess.addEventListener('statechange', emitMidiInputs);\n          return function () {\n            return midiAccess.removeEventListener('statechange', emitMidiInputs);\n          };\n        });\n      };\n    };\n\n    var createMidiOutputs = function createMidiOutputs(wrapSubscribeFunction) {\n      return function (midiAccess) {\n        return wrapSubscribeFunction(function (observer) {\n          var midiOutputs = Array.from(midiAccess.outputs.values());\n          var emitMidiOutputs = function emitMidiOutputs() {\n            var midiAccessOutputs = midiAccess.outputs;\n            if (midiOutputs.length !== midiAccessOutputs.size || midiOutputs.some(function (_ref) {\n              var id = _ref.id;\n              return !midiAccessOutputs.has(id);\n            })) {\n              midiOutputs = Array.from(midiAccessOutputs.values());\n              observer.next(midiOutputs);\n            }\n          };\n          observer.next(midiOutputs);\n          midiAccess.addEventListener('statechange', emitMidiOutputs);\n          return function () {\n            return midiAccess.removeEventListener('statechange', emitMidiOutputs);\n          };\n        });\n      };\n    };\n\n    var createMutations = function createMutations(emitNotSupportedError, window, wrapSubscribeFunction) {\n      return function (htmlElement, options) {\n        return wrapSubscribeFunction(function (observer) {\n          if (window === null || window.MutationObserver === undefined) {\n            return emitNotSupportedError(observer);\n          }\n          var mutationObserver = new window.MutationObserver(function (records) {\n            return observer.next(records);\n          });\n          try {\n            mutationObserver.observe(htmlElement, options);\n          } catch (err) {\n            observer.error(err);\n          }\n          return function () {\n            return mutationObserver.disconnect();\n          };\n        });\n      };\n    };\n\n    var createOn = function createOn(wrapSubscribeFunction) {\n      return function (target, type, options) {\n        return wrapSubscribeFunction(function (observer) {\n          var listener = function listener(event) {\n            return observer.next(event);\n          };\n          target.addEventListener(type, listener, options);\n          return function () {\n            return target.removeEventListener(type, listener, options);\n          };\n        });\n      };\n    };\n\n    var createOnline = function createOnline(emitNotSupportedError, window, wrapSubscribeFunction) {\n      return function () {\n        return wrapSubscribeFunction(function (observer) {\n          if (window === null || window.navigator === undefined || window.navigator.onLine === undefined) {\n            return emitNotSupportedError(observer);\n          }\n          var emitFalse = function emitFalse() {\n            return observer.next(false);\n          };\n          var emitTrue = function emitTrue() {\n            return observer.next(true);\n          };\n          window.addEventListener('offline', emitFalse);\n          window.addEventListener('online', emitTrue);\n          observer.next(window.navigator.onLine);\n          return function () {\n            window.removeEventListener('offline', emitFalse);\n            window.removeEventListener('online', emitTrue);\n          };\n        });\n      };\n    };\n\n    var createPermissionState = function createPermissionState(emitNotSupportedError, window, wrapSubscribeFunction) {\n      return function (permissionDescriptor) {\n        return wrapSubscribeFunction(function (observer) {\n          if (window === null || window.navigator === undefined || window.navigator.permissions === undefined || window.navigator.permissions.query === undefined) {\n            return emitNotSupportedError(observer);\n          }\n          var isActive = true;\n          var unsubscribe = function unsubscribe() {\n            isActive = false;\n          };\n          window.navigator.permissions.query(permissionDescriptor).then(function (permissionStatus) {\n            if (isActive) {\n              observer.next(permissionStatus.state);\n            }\n            if (isActive) {\n              permissionStatus.onchange = function () {\n                return observer.next(permissionStatus.state);\n              };\n              unsubscribe = function unsubscribe() {\n                permissionStatus.onchange = null;\n              };\n            }\n          }, function (err) {\n            if (isActive) {\n              observer.error(err);\n            }\n          });\n          return function () {\n            return unsubscribe();\n          };\n        });\n      };\n    };\n\n    var createPrependSubscribableThing = function createPrependSubscribableThing(wrapSubscribeFunction) {\n      return function (subscribableThing, prependedValue) {\n        return wrapSubscribeFunction(function (observer) {\n          observer.next(prependedValue);\n          return subscribableThing(observer);\n        });\n      };\n    };\n\n    var createReports = function createReports(emitNotSupportedError, window, wrapSubscribeFunction) {\n      return function (options) {\n        return wrapSubscribeFunction(function (observer) {\n          if (window === null || window.ReportingObserver === undefined) {\n            return emitNotSupportedError(observer);\n          }\n          var reportingObserver = new window.ReportingObserver(function (reportList) {\n            return observer.next(reportList);\n          }, options);\n          reportingObserver.observe();\n          return function () {\n            return reportingObserver.disconnect();\n          };\n        });\n      };\n    };\n\n    var createResizes = function createResizes(emitNotSupportedError, window, wrapSubscribeFunction) {\n      return function (htmlElement, options) {\n        return wrapSubscribeFunction(function (observer) {\n          if (window === null || window.ResizeObserver === undefined) {\n            return emitNotSupportedError(observer);\n          }\n          var resizeObserver = new window.ResizeObserver(function (entries) {\n            return observer.next(entries);\n          });\n          try {\n            resizeObserver.observe(htmlElement, options);\n          } catch (err) {\n            observer.error(err);\n          }\n          return function () {\n            return resizeObserver.disconnect();\n          };\n        });\n      };\n    };\n\n    var createUnhandledRejection = function createUnhandledRejection(emitNotSupportedError, window, wrapSubscribeFunction) {\n      return function (coolingOffPeriod) {\n        return wrapSubscribeFunction(function (observer) {\n          if (window === null || window.clearInterval === undefined || window.setInterval === undefined) {\n            return emitNotSupportedError(observer);\n          }\n          var possiblyUnhandledRejections = new Map();\n          var intervalId = null;\n          var deletePossiblyUnhandledRejection = function deletePossiblyUnhandledRejection(_ref) {\n            var promise = _ref.promise;\n            return possiblyUnhandledRejections[\"delete\"](promise);\n          };\n          var emitUnhandledRejection = function emitUnhandledRejection() {\n            var latestTimestampToEmit = Date.now() - coolingOffPeriod;\n            possiblyUnhandledRejections.forEach(function (_ref2, promise) {\n              var reason = _ref2.reason,\n                timestamp = _ref2.timestamp;\n              if (timestamp > latestTimestampToEmit) {\n                return;\n              }\n              possiblyUnhandledRejections[\"delete\"](promise);\n              observer.next(reason);\n            });\n            if (intervalId !== null && possiblyUnhandledRejections.size === 0) {\n              window.clearInterval(intervalId);\n              intervalId = null;\n            }\n          };\n          var registerPossiblyUnhandledRejection = function registerPossiblyUnhandledRejection(event) {\n            event.preventDefault();\n            possiblyUnhandledRejections.set(event.promise, {\n              reason: event.reason,\n              timestamp: Date.now()\n            });\n            if (intervalId === null) {\n              intervalId = window.setInterval(emitUnhandledRejection, coolingOffPeriod / 2);\n            }\n          };\n          window.addEventListener('rejectionhandled', deletePossiblyUnhandledRejection);\n          window.addEventListener('unhandledrejection', registerPossiblyUnhandledRejection);\n          return function () {\n            if (intervalId !== null) {\n              window.clearInterval(intervalId);\n            }\n            window.removeEventListener('rejectionhandled', deletePossiblyUnhandledRejection);\n            window.removeEventListener('unhandledrejection', registerPossiblyUnhandledRejection);\n          };\n        });\n      };\n    };\n\n    function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\n    function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), true).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\n    var createVideoFrame = function createVideoFrame(emitNotSupportedError, wrapSubscribeFunction) {\n      return function (videoElement) {\n        return wrapSubscribeFunction(function (observer) {\n          if (videoElement.cancelVideoFrameCallback === undefined || videoElement.requestVideoFrameCallback === undefined) {\n            return emitNotSupportedError(observer);\n          }\n          var videoFrameHandle = videoElement.requestVideoFrameCallback(function videoFrameCallback(now, metadata) {\n            videoFrameHandle = videoElement.requestVideoFrameCallback(videoFrameCallback);\n            observer.next(_objectSpread(_objectSpread({}, metadata), {}, {\n              now: now\n            }));\n          });\n          return function () {\n            return videoElement.cancelVideoFrameCallback(videoFrameHandle);\n          };\n        });\n      };\n    };\n\n    var createWakeLock = function createWakeLock(emitNotSupportedError, window, wrapSubscribeFunction) {\n      return function (type) {\n        return wrapSubscribeFunction(function (observer) {\n          if (window === null || window.navigator === undefined || window.navigator.wakeLock === undefined) {\n            return emitNotSupportedError(observer);\n          }\n          var releaseWakeLock = function releaseWakeLock(wakeLockSentinel) {\n            return wakeLockSentinel.release()[\"catch\"](function () {\n              // Ignore errors.\n            });\n          };\n          var removeReleaseEventListener = function removeReleaseEventListener(wakeLockSentinel) {\n            wakeLockSentinel.onrelease = null;\n          };\n          var isActive = true;\n          var unsubscribeWhileRequesting = function unsubscribeWhileRequesting() {\n            isActive = false;\n          };\n          var unsubscribe = unsubscribeWhileRequesting;\n          var _requestWakeLock = function requestWakeLock() {\n            return window.navigator.wakeLock.request(type).then(function (wakeLockSentinel) {\n              if (isActive) {\n                observer.next(true);\n              }\n              if (isActive) {\n                wakeLockSentinel.onrelease = function () {\n                  observer.next(false);\n                  unsubscribe = unsubscribeWhileRequesting;\n                  removeReleaseEventListener(wakeLockSentinel);\n                  _requestWakeLock();\n                };\n                unsubscribe = function unsubscribe() {\n                  removeReleaseEventListener(wakeLockSentinel);\n                  releaseWakeLock(wakeLockSentinel);\n                };\n              } else {\n                releaseWakeLock(wakeLockSentinel);\n              }\n            }, function (err) {\n              if (isActive) {\n                observer.error(err);\n              }\n            });\n          };\n          _requestWakeLock();\n          return function () {\n            return unsubscribe();\n          };\n        });\n      };\n    };\n\n    // @todo TypeScript does not include type definitions for the Reporting API yet.\n    var createWindow = function createWindow() {\n      return typeof window === 'undefined' ? null : window;\n    };\n\n    var createWrapSubscribeFunction = function createWrapSubscribeFunction(patch, toObserver) {\n      var emptyFunction = function emptyFunction() {}; // tslint:disable-line:no-empty\n      var isNextFunction = function isNextFunction(args) {\n        return typeof args[0] === 'function';\n      };\n      return function (innerSubscribe) {\n        var _subscribe = function subscribe() {\n          for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n          }\n          var unsubscribe = innerSubscribe(isNextFunction(args) ? toObserver({\n            next: args[0]\n          }) : toObserver.apply(void 0, args));\n          if (unsubscribe !== undefined) {\n            return unsubscribe;\n          }\n          return emptyFunction;\n        };\n        _subscribe[Symbol.observable] = function () {\n          return {\n            subscribe: function subscribe() {\n              return {\n                unsubscribe: _subscribe.apply(void 0, arguments)\n              };\n            }\n          };\n        };\n        return patch(_subscribe);\n      };\n    };\n\n    var emitNotSupportedError = function emitNotSupportedError(observer) {\n      observer.error(new Error('The required browser API seems to be not supported.'));\n      return function () {}; // tslint:disable-line:no-empty\n    };\n\n    var window$1 = createWindow();\n    var wrapSubscribeFunction = createWrapSubscribeFunction(rxjsInterop.patch, rxjsInterop.toObserver);\n    var animationFrame = createAnimationFrame(emitNotSupportedError, window$1, wrapSubscribeFunction);\n    var mutations = createMutations(emitNotSupportedError, window$1, wrapSubscribeFunction);\n    var mapSubscribableThing = createMapSubscribableThing(wrapSubscribeFunction);\n    var prependSubscribableThing = createPrependSubscribableThing(wrapSubscribeFunction);\n    var attribute = createAttribute(mapSubscribableThing, mutations, prependSubscribableThing);\n    var geolocation = createGeolocation(emitNotSupportedError, window$1, wrapSubscribeFunction);\n    var intersections = createIntersections(emitNotSupportedError, window$1, wrapSubscribeFunction);\n    var mediaDevices = createMediaDevices(emitNotSupportedError, window$1, wrapSubscribeFunction);\n    var mediaQueryMatch = createMediaQueryMatch(emitNotSupportedError, window$1, wrapSubscribeFunction);\n    var metrics = createMetrics(emitNotSupportedError, window$1, wrapSubscribeFunction);\n    var midiInputs = createMidiInputs(wrapSubscribeFunction);\n    var midiOutputs = createMidiOutputs(wrapSubscribeFunction);\n    var on = createOn(wrapSubscribeFunction);\n    var online = createOnline(emitNotSupportedError, window$1, wrapSubscribeFunction);\n    var permissionState = createPermissionState(emitNotSupportedError, window$1, wrapSubscribeFunction);\n    var reports = createReports(emitNotSupportedError, window$1, wrapSubscribeFunction);\n    var resizes = createResizes(emitNotSupportedError, window$1, wrapSubscribeFunction);\n    var unhandledRejection = createUnhandledRejection(emitNotSupportedError, window$1, wrapSubscribeFunction);\n    var videoFrame = createVideoFrame(emitNotSupportedError, wrapSubscribeFunction);\n    var wakeLock = createWakeLock(emitNotSupportedError, window$1, wrapSubscribeFunction);\n\n    exports.animationFrame = animationFrame;\n    exports.attribute = attribute;\n    exports.geolocation = geolocation;\n    exports.intersections = intersections;\n    exports.mediaDevices = mediaDevices;\n    exports.mediaQueryMatch = mediaQueryMatch;\n    exports.metrics = metrics;\n    exports.midiInputs = midiInputs;\n    exports.midiOutputs = midiOutputs;\n    exports.mutations = mutations;\n    exports.on = on;\n    exports.online = online;\n    exports.permissionState = permissionState;\n    exports.reports = reports;\n    exports.resizes = resizes;\n    exports.unhandledRejection = unhandledRejection;\n    exports.videoFrame = videoFrame;\n    exports.wakeLock = wakeLock;\n\n}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvc3Vic2NyaWJhYmxlLXRoaW5ncy9idWlsZC9lczUvYnVuZGxlLmpzIiwibWFwcGluZ3MiOiJBQUFBO0FBQ0EsSUFBSSxLQUE0RCxvQkFBb0IsbUJBQU8sQ0FBQyx5RUFBYyxHQUFHLG1CQUFPLENBQUMsNEdBQXVDO0FBQzVKLElBQUksQ0FDK0o7QUFDbkssQ0FBQyw0REFBNEQ7O0FBRTdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUEsK0JBQStCLHdCQUF3QixvQ0FBb0MseUNBQXlDLGtDQUFrQywwREFBMEQsMEJBQTBCO0FBQzFQLGtDQUFrQyxnQkFBZ0Isc0JBQXNCLE9BQU8sa0RBQWtELDBEQUEwRCw4QkFBOEIscUpBQXFKLHFFQUFxRSxLQUFLO0FBQ3hiO0FBQ0E7QUFDQTtBQUNBLHFFQUFxRSxlQUFlO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBLDZCQUE2Qix3QkFBd0Isb0NBQW9DLHlDQUF5QyxrQ0FBa0MsMERBQTBELDBCQUEwQjtBQUN4UCxnQ0FBZ0MsZ0JBQWdCLHNCQUFzQixPQUFPLGtEQUFrRCx3REFBd0QsOEJBQThCLG1KQUFtSixxRUFBcUUsS0FBSztBQUNsYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0RBQXdELGVBQWU7QUFDdkU7QUFDQSxhQUFhO0FBQ2IsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx1REFBdUQ7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhFQUE4RSxhQUFhO0FBQzNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDZCQUE2QjtBQUM3Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL25leHRqcy8uL25vZGVfbW9kdWxlcy9zdWJzY3JpYmFibGUtdGhpbmdzL2J1aWxkL2VzNS9idW5kbGUuanM/ODY5YSJdLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuICAgIHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyA/IGZhY3RvcnkoZXhwb3J0cywgcmVxdWlyZSgncnhqcy1pbnRlcm9wJyksIHJlcXVpcmUoJ0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZGVmaW5lUHJvcGVydHknKSkgOlxuICAgIHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShbJ2V4cG9ydHMnLCAncnhqcy1pbnRlcm9wJywgJ0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZGVmaW5lUHJvcGVydHknXSwgZmFjdG9yeSkgOlxuICAgIChnbG9iYWwgPSB0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWxUaGlzIDogZ2xvYmFsIHx8IHNlbGYsIGZhY3RvcnkoZ2xvYmFsLnN1YnNjcmliYWJsZVRoaW5ncyA9IHt9LCBnbG9iYWwucnhqc0ludGVyb3AsIGdsb2JhbC5fZGVmaW5lUHJvcGVydHkpKTtcbn0pKHRoaXMsIChmdW5jdGlvbiAoZXhwb3J0cywgcnhqc0ludGVyb3AsIF9kZWZpbmVQcm9wZXJ0eSkgeyAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgY3JlYXRlQW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbiBjcmVhdGVBbmltYXRpb25GcmFtZShlbWl0Tm90U3VwcG9ydGVkRXJyb3IsIHdpbmRvdywgd3JhcFN1YnNjcmliZUZ1bmN0aW9uKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gd3JhcFN1YnNjcmliZUZ1bmN0aW9uKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgIGlmICh3aW5kb3cgPT09IG51bGwgfHwgd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lID09PSB1bmRlZmluZWQgfHwgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gZW1pdE5vdFN1cHBvcnRlZEVycm9yKG9ic2VydmVyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGFuaW1hdGlvbkZyYW1lSGFuZGxlID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiBhbmltYXRpb25GcmFtZUNhbGxiYWNrKHRpbWVzdGFtcCkge1xuICAgICAgICAgICAgYW5pbWF0aW9uRnJhbWVIYW5kbGUgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGlvbkZyYW1lQ2FsbGJhY2spO1xuICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dCh0aW1lc3RhbXApO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKGFuaW1hdGlvbkZyYW1lSGFuZGxlKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfTtcblxuICAgIHZhciBjcmVhdGVBdHRyaWJ1dGUgPSBmdW5jdGlvbiBjcmVhdGVBdHRyaWJ1dGUobWFwU3Vic2NyaWJhYmxlVGhpbmcsIG11dGF0aW9ucywgcHJlcGVuZFN1YnNjcmliYWJsZVRoaW5nKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKGh0bWxFbGVtZW50LCBuYW1lKSB7XG4gICAgICAgIHZhciBnZXRBdHRyaWJ1dGUgPSBmdW5jdGlvbiBnZXRBdHRyaWJ1dGUoKSB7XG4gICAgICAgICAgcmV0dXJuIGh0bWxFbGVtZW50LmdldEF0dHJpYnV0ZShuYW1lKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHByZXBlbmRTdWJzY3JpYmFibGVUaGluZyhtYXBTdWJzY3JpYmFibGVUaGluZyhtdXRhdGlvbnMoaHRtbEVsZW1lbnQsIHtcbiAgICAgICAgICBhdHRyaWJ1dGVGaWx0ZXI6IFtuYW1lXSxcbiAgICAgICAgICBjaGlsZExpc3Q6IGZhbHNlLFxuICAgICAgICAgIHN1YnRyZWU6IGZhbHNlXG4gICAgICAgIH0pLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIGdldEF0dHJpYnV0ZSgpO1xuICAgICAgICB9KSwgZ2V0QXR0cmlidXRlKCkpO1xuICAgICAgfTtcbiAgICB9O1xuXG4gICAgdmFyIGNyZWF0ZUdlb2xvY2F0aW9uID0gZnVuY3Rpb24gY3JlYXRlR2VvbG9jYXRpb24oZW1pdE5vdFN1cHBvcnRlZEVycm9yLCB3aW5kb3csIHdyYXBTdWJzY3JpYmVGdW5jdGlvbikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB3cmFwU3Vic2NyaWJlRnVuY3Rpb24oZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgICAgaWYgKHdpbmRvdyA9PT0gbnVsbCB8fCB3aW5kb3cubmF2aWdhdG9yID09PSB1bmRlZmluZWQgfHwgd2luZG93Lm5hdmlnYXRvci5nZW9sb2NhdGlvbiA9PT0gdW5kZWZpbmVkIHx8IHdpbmRvdy5uYXZpZ2F0b3IuZ2VvbG9jYXRpb24uY2xlYXJXYXRjaCA9PT0gdW5kZWZpbmVkIHx8IHdpbmRvdy5uYXZpZ2F0b3IuZ2VvbG9jYXRpb24ud2F0Y2hQb3NpdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gZW1pdE5vdFN1cHBvcnRlZEVycm9yKG9ic2VydmVyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHdhdGNoSWQgPSB3aW5kb3cubmF2aWdhdG9yLmdlb2xvY2F0aW9uLndhdGNoUG9zaXRpb24oZnVuY3Rpb24gKHBvc2l0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gb2JzZXJ2ZXIubmV4dChwb3NpdGlvbik7XG4gICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgcmV0dXJuIG9ic2VydmVyLmVycm9yKGVycik7XG4gICAgICAgICAgfSwgb3B0aW9ucyk7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cubmF2aWdhdG9yLmdlb2xvY2F0aW9uLmNsZWFyV2F0Y2god2F0Y2hJZCk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH07XG5cbiAgICB2YXIgY3JlYXRlSW50ZXJzZWN0aW9ucyA9IGZ1bmN0aW9uIGNyZWF0ZUludGVyc2VjdGlvbnMoZW1pdE5vdFN1cHBvcnRlZEVycm9yLCB3aW5kb3csIHdyYXBTdWJzY3JpYmVGdW5jdGlvbikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIChodG1sRWxlbWVudCwgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gd3JhcFN1YnNjcmliZUZ1bmN0aW9uKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgIGlmICh3aW5kb3cgPT09IG51bGwgfHwgd2luZG93LkludGVyc2VjdGlvbk9ic2VydmVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBlbWl0Tm90U3VwcG9ydGVkRXJyb3Iob2JzZXJ2ZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgaW50ZXJzZWN0aW9uT2JzZXJ2ZXJPYnNlcnZlciA9IG5ldyB3aW5kb3cuSW50ZXJzZWN0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKGVudHJpZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBvYnNlcnZlci5uZXh0KGVudHJpZXMpO1xuICAgICAgICAgIH0sIG9wdGlvbnMpO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpbnRlcnNlY3Rpb25PYnNlcnZlck9ic2VydmVyLm9ic2VydmUoaHRtbEVsZW1lbnQpO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IoZXJyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBpbnRlcnNlY3Rpb25PYnNlcnZlck9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIG93bktleXMkMShlLCByKSB7IHZhciB0ID0gT2JqZWN0LmtleXMoZSk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBvID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTsgciAmJiAobyA9IG8uZmlsdGVyKGZ1bmN0aW9uIChyKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsIHIpLmVudW1lcmFibGU7IH0pKSwgdC5wdXNoLmFwcGx5KHQsIG8pOyB9IHJldHVybiB0OyB9XG4gICAgZnVuY3Rpb24gX29iamVjdFNwcmVhZCQxKGUpIHsgZm9yICh2YXIgciA9IDE7IHIgPCBhcmd1bWVudHMubGVuZ3RoOyByKyspIHsgdmFyIHQgPSBudWxsICE9IGFyZ3VtZW50c1tyXSA/IGFyZ3VtZW50c1tyXSA6IHt9OyByICUgMiA/IG93bktleXMkMShPYmplY3QodCksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKHIpIHsgX2RlZmluZVByb3BlcnR5KGUsIHIsIHRbcl0pOyB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnModCkpIDogb3duS2V5cyQxKE9iamVjdCh0KSkuZm9yRWFjaChmdW5jdGlvbiAocikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgciwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LCByKSk7IH0pOyB9IHJldHVybiBlOyB9XG4gICAgdmFyIGNyZWF0ZU1hcFN1YnNjcmliYWJsZVRoaW5nID0gZnVuY3Rpb24gY3JlYXRlTWFwU3Vic2NyaWJhYmxlVGhpbmcod3JhcFN1YnNjcmliZUZ1bmN0aW9uKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKHN1YnNjcmliYWJsZVRoaW5nLCBtYXApIHtcbiAgICAgICAgcmV0dXJuIHdyYXBTdWJzY3JpYmVGdW5jdGlvbihmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICByZXR1cm4gc3Vic2NyaWJhYmxlVGhpbmcoX29iamVjdFNwcmVhZCQxKF9vYmplY3RTcHJlYWQkMSh7fSwgb2JzZXJ2ZXIpLCB7fSwge1xuICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24gbmV4dCh2YWx1ZSkge1xuICAgICAgICAgICAgICByZXR1cm4gb2JzZXJ2ZXIubmV4dChtYXAodmFsdWUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9O1xuXG4gICAgdmFyIGNyZWF0ZU1lZGlhRGV2aWNlcyA9IGZ1bmN0aW9uIGNyZWF0ZU1lZGlhRGV2aWNlcyhlbWl0Tm90U3VwcG9ydGVkRXJyb3IsIHdpbmRvdywgd3JhcFN1YnNjcmliZUZ1bmN0aW9uKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gd3JhcFN1YnNjcmliZUZ1bmN0aW9uKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgIGlmICh3aW5kb3cgPT09IG51bGwgfHwgd2luZG93Lm5hdmlnYXRvciA9PT0gdW5kZWZpbmVkIHx8IHdpbmRvdy5uYXZpZ2F0b3IubWVkaWFEZXZpY2VzID09PSB1bmRlZmluZWQgfHwgd2luZG93Lm5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gZW1pdE5vdFN1cHBvcnRlZEVycm9yKG9ic2VydmVyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGlzQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICB2YXIgZW51bWVyYXRlRGV2aWNlcyA9IGZ1bmN0aW9uIGVudW1lcmF0ZURldmljZXMoKSB7XG4gICAgICAgICAgICB3aW5kb3cubmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzKCkudGhlbihmdW5jdGlvbiAobWVkaWFEZXZpY2VzKSB7XG4gICAgICAgICAgICAgIGlmIChpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQobWVkaWFEZXZpY2VzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICBpZiAoaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICB1bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKGVycik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH07XG4gICAgICAgICAgdmFyIHVuc3Vic2NyaWJlID0gZnVuY3Rpb24gdW5zdWJzY3JpYmUoKSB7XG4gICAgICAgICAgICBpc0FjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgd2luZG93Lm5hdmlnYXRvci5tZWRpYURldmljZXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignZGV2aWNlY2hhbmdlJywgZW51bWVyYXRlRGV2aWNlcyk7XG4gICAgICAgICAgfTtcbiAgICAgICAgICBlbnVtZXJhdGVEZXZpY2VzKCk7XG4gICAgICAgICAgd2luZG93Lm5hdmlnYXRvci5tZWRpYURldmljZXMuYWRkRXZlbnRMaXN0ZW5lcignZGV2aWNlY2hhbmdlJywgZW51bWVyYXRlRGV2aWNlcyk7XG4gICAgICAgICAgcmV0dXJuIHVuc3Vic2NyaWJlO1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfTtcblxuICAgIHZhciBjcmVhdGVNZWRpYVF1ZXJ5TWF0Y2ggPSBmdW5jdGlvbiBjcmVhdGVNZWRpYVF1ZXJ5TWF0Y2goZW1pdE5vdFN1cHBvcnRlZEVycm9yLCB3aW5kb3csIHdyYXBTdWJzY3JpYmVGdW5jdGlvbikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtZWRpYVF1ZXJ5U3RyaW5nKSB7XG4gICAgICAgIHJldHVybiB3cmFwU3Vic2NyaWJlRnVuY3Rpb24oZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgICAgaWYgKHdpbmRvdyA9PT0gbnVsbCB8fCB3aW5kb3cubWF0Y2hNZWRpYSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gZW1pdE5vdFN1cHBvcnRlZEVycm9yKG9ic2VydmVyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIG1lZGlhUXVlcnlMaXN0ID0gd2luZG93Lm1hdGNoTWVkaWEobWVkaWFRdWVyeVN0cmluZyk7XG4gICAgICAgICAgb2JzZXJ2ZXIubmV4dChtZWRpYVF1ZXJ5TGlzdC5tYXRjaGVzKTtcbiAgICAgICAgICBtZWRpYVF1ZXJ5TGlzdC5vbmNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBvYnNlcnZlci5uZXh0KG1lZGlhUXVlcnlMaXN0Lm1hdGNoZXMpO1xuICAgICAgICAgIH07XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIG1lZGlhUXVlcnlMaXN0Lm9uY2hhbmdlID0gbnVsbDtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfTtcblxuICAgIHZhciBjcmVhdGVNZXRyaWNzID0gZnVuY3Rpb24gY3JlYXRlTWV0cmljcyhlbWl0Tm90U3VwcG9ydGVkRXJyb3IsIHdpbmRvdywgd3JhcFN1YnNjcmliZUZ1bmN0aW9uKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHdyYXBTdWJzY3JpYmVGdW5jdGlvbihmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICBpZiAod2luZG93ID09PSBudWxsIHx8IHdpbmRvdy5QZXJmb3JtYW5jZU9ic2VydmVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBlbWl0Tm90U3VwcG9ydGVkRXJyb3Iob2JzZXJ2ZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcGVyZm9ybWFuY2VPYnNlcnZlciA9IG5ldyB3aW5kb3cuUGVyZm9ybWFuY2VPYnNlcnZlcihmdW5jdGlvbiAoZW50cnlMaXN0KSB7XG4gICAgICAgICAgICByZXR1cm4gb2JzZXJ2ZXIubmV4dChlbnRyeUxpc3QuZ2V0RW50cmllcygpKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcGVyZm9ybWFuY2VPYnNlcnZlci5vYnNlcnZlKG9wdGlvbnMpO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IoZXJyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBwZXJmb3JtYW5jZU9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfTtcblxuICAgIHZhciBjcmVhdGVNaWRpSW5wdXRzID0gZnVuY3Rpb24gY3JlYXRlTWlkaUlucHV0cyh3cmFwU3Vic2NyaWJlRnVuY3Rpb24pIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAobWlkaUFjY2Vzcykge1xuICAgICAgICByZXR1cm4gd3JhcFN1YnNjcmliZUZ1bmN0aW9uKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgIHZhciBtaWRpSW5wdXRzID0gQXJyYXkuZnJvbShtaWRpQWNjZXNzLmlucHV0cy52YWx1ZXMoKSk7XG4gICAgICAgICAgdmFyIGVtaXRNaWRpSW5wdXRzID0gZnVuY3Rpb24gZW1pdE1pZGlJbnB1dHMoKSB7XG4gICAgICAgICAgICB2YXIgbWlkaUFjY2Vzc0lucHV0cyA9IG1pZGlBY2Nlc3MuaW5wdXRzO1xuICAgICAgICAgICAgaWYgKG1pZGlJbnB1dHMubGVuZ3RoICE9PSBtaWRpQWNjZXNzSW5wdXRzLnNpemUgfHwgbWlkaUlucHV0cy5zb21lKGZ1bmN0aW9uIChfcmVmKSB7XG4gICAgICAgICAgICAgIHZhciBpZCA9IF9yZWYuaWQ7XG4gICAgICAgICAgICAgIHJldHVybiAhbWlkaUFjY2Vzc0lucHV0cy5oYXMoaWQpO1xuICAgICAgICAgICAgfSkpIHtcbiAgICAgICAgICAgICAgbWlkaUlucHV0cyA9IEFycmF5LmZyb20obWlkaUFjY2Vzc0lucHV0cy52YWx1ZXMoKSk7XG4gICAgICAgICAgICAgIG9ic2VydmVyLm5leHQobWlkaUlucHV0cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgICBvYnNlcnZlci5uZXh0KG1pZGlJbnB1dHMpO1xuICAgICAgICAgIG1pZGlBY2Nlc3MuYWRkRXZlbnRMaXN0ZW5lcignc3RhdGVjaGFuZ2UnLCBlbWl0TWlkaUlucHV0cyk7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBtaWRpQWNjZXNzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3N0YXRlY2hhbmdlJywgZW1pdE1pZGlJbnB1dHMpO1xuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9O1xuXG4gICAgdmFyIGNyZWF0ZU1pZGlPdXRwdXRzID0gZnVuY3Rpb24gY3JlYXRlTWlkaU91dHB1dHMod3JhcFN1YnNjcmliZUZ1bmN0aW9uKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKG1pZGlBY2Nlc3MpIHtcbiAgICAgICAgcmV0dXJuIHdyYXBTdWJzY3JpYmVGdW5jdGlvbihmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICB2YXIgbWlkaU91dHB1dHMgPSBBcnJheS5mcm9tKG1pZGlBY2Nlc3Mub3V0cHV0cy52YWx1ZXMoKSk7XG4gICAgICAgICAgdmFyIGVtaXRNaWRpT3V0cHV0cyA9IGZ1bmN0aW9uIGVtaXRNaWRpT3V0cHV0cygpIHtcbiAgICAgICAgICAgIHZhciBtaWRpQWNjZXNzT3V0cHV0cyA9IG1pZGlBY2Nlc3Mub3V0cHV0cztcbiAgICAgICAgICAgIGlmIChtaWRpT3V0cHV0cy5sZW5ndGggIT09IG1pZGlBY2Nlc3NPdXRwdXRzLnNpemUgfHwgbWlkaU91dHB1dHMuc29tZShmdW5jdGlvbiAoX3JlZikge1xuICAgICAgICAgICAgICB2YXIgaWQgPSBfcmVmLmlkO1xuICAgICAgICAgICAgICByZXR1cm4gIW1pZGlBY2Nlc3NPdXRwdXRzLmhhcyhpZCk7XG4gICAgICAgICAgICB9KSkge1xuICAgICAgICAgICAgICBtaWRpT3V0cHV0cyA9IEFycmF5LmZyb20obWlkaUFjY2Vzc091dHB1dHMudmFsdWVzKCkpO1xuICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KG1pZGlPdXRwdXRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICAgIG9ic2VydmVyLm5leHQobWlkaU91dHB1dHMpO1xuICAgICAgICAgIG1pZGlBY2Nlc3MuYWRkRXZlbnRMaXN0ZW5lcignc3RhdGVjaGFuZ2UnLCBlbWl0TWlkaU91dHB1dHMpO1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gbWlkaUFjY2Vzcy5yZW1vdmVFdmVudExpc3RlbmVyKCdzdGF0ZWNoYW5nZScsIGVtaXRNaWRpT3V0cHV0cyk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH07XG5cbiAgICB2YXIgY3JlYXRlTXV0YXRpb25zID0gZnVuY3Rpb24gY3JlYXRlTXV0YXRpb25zKGVtaXROb3RTdXBwb3J0ZWRFcnJvciwgd2luZG93LCB3cmFwU3Vic2NyaWJlRnVuY3Rpb24pIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAoaHRtbEVsZW1lbnQsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHdyYXBTdWJzY3JpYmVGdW5jdGlvbihmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICBpZiAod2luZG93ID09PSBudWxsIHx8IHdpbmRvdy5NdXRhdGlvbk9ic2VydmVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBlbWl0Tm90U3VwcG9ydGVkRXJyb3Iob2JzZXJ2ZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgbXV0YXRpb25PYnNlcnZlciA9IG5ldyB3aW5kb3cuTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbiAocmVjb3Jkcykge1xuICAgICAgICAgICAgcmV0dXJuIG9ic2VydmVyLm5leHQocmVjb3Jkcyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG11dGF0aW9uT2JzZXJ2ZXIub2JzZXJ2ZShodG1sRWxlbWVudCwgb3B0aW9ucyk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBvYnNlcnZlci5lcnJvcihlcnIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIG11dGF0aW9uT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9O1xuXG4gICAgdmFyIGNyZWF0ZU9uID0gZnVuY3Rpb24gY3JlYXRlT24od3JhcFN1YnNjcmliZUZ1bmN0aW9uKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwgdHlwZSwgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gd3JhcFN1YnNjcmliZUZ1bmN0aW9uKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgIHZhciBsaXN0ZW5lciA9IGZ1bmN0aW9uIGxpc3RlbmVyKGV2ZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gb2JzZXJ2ZXIubmV4dChldmVudCk7XG4gICAgICAgICAgfTtcbiAgICAgICAgICB0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH07XG5cbiAgICB2YXIgY3JlYXRlT25saW5lID0gZnVuY3Rpb24gY3JlYXRlT25saW5lKGVtaXROb3RTdXBwb3J0ZWRFcnJvciwgd2luZG93LCB3cmFwU3Vic2NyaWJlRnVuY3Rpb24pIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB3cmFwU3Vic2NyaWJlRnVuY3Rpb24oZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgICAgaWYgKHdpbmRvdyA9PT0gbnVsbCB8fCB3aW5kb3cubmF2aWdhdG9yID09PSB1bmRlZmluZWQgfHwgd2luZG93Lm5hdmlnYXRvci5vbkxpbmUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIGVtaXROb3RTdXBwb3J0ZWRFcnJvcihvYnNlcnZlcik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBlbWl0RmFsc2UgPSBmdW5jdGlvbiBlbWl0RmFsc2UoKSB7XG4gICAgICAgICAgICByZXR1cm4gb2JzZXJ2ZXIubmV4dChmYWxzZSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgICB2YXIgZW1pdFRydWUgPSBmdW5jdGlvbiBlbWl0VHJ1ZSgpIHtcbiAgICAgICAgICAgIHJldHVybiBvYnNlcnZlci5uZXh0KHRydWUpO1xuICAgICAgICAgIH07XG4gICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ29mZmxpbmUnLCBlbWl0RmFsc2UpO1xuICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvbmxpbmUnLCBlbWl0VHJ1ZSk7XG4gICAgICAgICAgb2JzZXJ2ZXIubmV4dCh3aW5kb3cubmF2aWdhdG9yLm9uTGluZSk7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdvZmZsaW5lJywgZW1pdEZhbHNlKTtcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdvbmxpbmUnLCBlbWl0VHJ1ZSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH07XG5cbiAgICB2YXIgY3JlYXRlUGVybWlzc2lvblN0YXRlID0gZnVuY3Rpb24gY3JlYXRlUGVybWlzc2lvblN0YXRlKGVtaXROb3RTdXBwb3J0ZWRFcnJvciwgd2luZG93LCB3cmFwU3Vic2NyaWJlRnVuY3Rpb24pIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAocGVybWlzc2lvbkRlc2NyaXB0b3IpIHtcbiAgICAgICAgcmV0dXJuIHdyYXBTdWJzY3JpYmVGdW5jdGlvbihmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICBpZiAod2luZG93ID09PSBudWxsIHx8IHdpbmRvdy5uYXZpZ2F0b3IgPT09IHVuZGVmaW5lZCB8fCB3aW5kb3cubmF2aWdhdG9yLnBlcm1pc3Npb25zID09PSB1bmRlZmluZWQgfHwgd2luZG93Lm5hdmlnYXRvci5wZXJtaXNzaW9ucy5xdWVyeSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gZW1pdE5vdFN1cHBvcnRlZEVycm9yKG9ic2VydmVyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGlzQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICB2YXIgdW5zdWJzY3JpYmUgPSBmdW5jdGlvbiB1bnN1YnNjcmliZSgpIHtcbiAgICAgICAgICAgIGlzQWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgfTtcbiAgICAgICAgICB3aW5kb3cubmF2aWdhdG9yLnBlcm1pc3Npb25zLnF1ZXJ5KHBlcm1pc3Npb25EZXNjcmlwdG9yKS50aGVuKGZ1bmN0aW9uIChwZXJtaXNzaW9uU3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dChwZXJtaXNzaW9uU3RhdHVzLnN0YXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICBwZXJtaXNzaW9uU3RhdHVzLm9uY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvYnNlcnZlci5uZXh0KHBlcm1pc3Npb25TdGF0dXMuc3RhdGUpO1xuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB1bnN1YnNjcmliZSA9IGZ1bmN0aW9uIHVuc3Vic2NyaWJlKCkge1xuICAgICAgICAgICAgICAgIHBlcm1pc3Npb25TdGF0dXMub25jaGFuZ2UgPSBudWxsO1xuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIGlmIChpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICBvYnNlcnZlci5lcnJvcihlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfTtcblxuICAgIHZhciBjcmVhdGVQcmVwZW5kU3Vic2NyaWJhYmxlVGhpbmcgPSBmdW5jdGlvbiBjcmVhdGVQcmVwZW5kU3Vic2NyaWJhYmxlVGhpbmcod3JhcFN1YnNjcmliZUZ1bmN0aW9uKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKHN1YnNjcmliYWJsZVRoaW5nLCBwcmVwZW5kZWRWYWx1ZSkge1xuICAgICAgICByZXR1cm4gd3JhcFN1YnNjcmliZUZ1bmN0aW9uKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgIG9ic2VydmVyLm5leHQocHJlcGVuZGVkVmFsdWUpO1xuICAgICAgICAgIHJldHVybiBzdWJzY3JpYmFibGVUaGluZyhvYnNlcnZlcik7XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9O1xuXG4gICAgdmFyIGNyZWF0ZVJlcG9ydHMgPSBmdW5jdGlvbiBjcmVhdGVSZXBvcnRzKGVtaXROb3RTdXBwb3J0ZWRFcnJvciwgd2luZG93LCB3cmFwU3Vic2NyaWJlRnVuY3Rpb24pIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICByZXR1cm4gd3JhcFN1YnNjcmliZUZ1bmN0aW9uKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgIGlmICh3aW5kb3cgPT09IG51bGwgfHwgd2luZG93LlJlcG9ydGluZ09ic2VydmVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBlbWl0Tm90U3VwcG9ydGVkRXJyb3Iob2JzZXJ2ZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcmVwb3J0aW5nT2JzZXJ2ZXIgPSBuZXcgd2luZG93LlJlcG9ydGluZ09ic2VydmVyKGZ1bmN0aW9uIChyZXBvcnRMaXN0KSB7XG4gICAgICAgICAgICByZXR1cm4gb2JzZXJ2ZXIubmV4dChyZXBvcnRMaXN0KTtcbiAgICAgICAgICB9LCBvcHRpb25zKTtcbiAgICAgICAgICByZXBvcnRpbmdPYnNlcnZlci5vYnNlcnZlKCk7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiByZXBvcnRpbmdPYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgIH07XG5cbiAgICB2YXIgY3JlYXRlUmVzaXplcyA9IGZ1bmN0aW9uIGNyZWF0ZVJlc2l6ZXMoZW1pdE5vdFN1cHBvcnRlZEVycm9yLCB3aW5kb3csIHdyYXBTdWJzY3JpYmVGdW5jdGlvbikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIChodG1sRWxlbWVudCwgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gd3JhcFN1YnNjcmliZUZ1bmN0aW9uKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgIGlmICh3aW5kb3cgPT09IG51bGwgfHwgd2luZG93LlJlc2l6ZU9ic2VydmVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBlbWl0Tm90U3VwcG9ydGVkRXJyb3Iob2JzZXJ2ZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcmVzaXplT2JzZXJ2ZXIgPSBuZXcgd2luZG93LlJlc2l6ZU9ic2VydmVyKGZ1bmN0aW9uIChlbnRyaWVzKSB7XG4gICAgICAgICAgICByZXR1cm4gb2JzZXJ2ZXIubmV4dChlbnRyaWVzKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzaXplT2JzZXJ2ZXIub2JzZXJ2ZShodG1sRWxlbWVudCwgb3B0aW9ucyk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBvYnNlcnZlci5lcnJvcihlcnIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc2l6ZU9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfTtcblxuICAgIHZhciBjcmVhdGVVbmhhbmRsZWRSZWplY3Rpb24gPSBmdW5jdGlvbiBjcmVhdGVVbmhhbmRsZWRSZWplY3Rpb24oZW1pdE5vdFN1cHBvcnRlZEVycm9yLCB3aW5kb3csIHdyYXBTdWJzY3JpYmVGdW5jdGlvbikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjb29saW5nT2ZmUGVyaW9kKSB7XG4gICAgICAgIHJldHVybiB3cmFwU3Vic2NyaWJlRnVuY3Rpb24oZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgICAgaWYgKHdpbmRvdyA9PT0gbnVsbCB8fCB3aW5kb3cuY2xlYXJJbnRlcnZhbCA9PT0gdW5kZWZpbmVkIHx8IHdpbmRvdy5zZXRJbnRlcnZhbCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gZW1pdE5vdFN1cHBvcnRlZEVycm9yKG9ic2VydmVyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9ucyA9IG5ldyBNYXAoKTtcbiAgICAgICAgICB2YXIgaW50ZXJ2YWxJZCA9IG51bGw7XG4gICAgICAgICAgdmFyIGRlbGV0ZVBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uID0gZnVuY3Rpb24gZGVsZXRlUG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24oX3JlZikge1xuICAgICAgICAgICAgdmFyIHByb21pc2UgPSBfcmVmLnByb21pc2U7XG4gICAgICAgICAgICByZXR1cm4gcG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb25zW1wiZGVsZXRlXCJdKHByb21pc2UpO1xuICAgICAgICAgIH07XG4gICAgICAgICAgdmFyIGVtaXRVbmhhbmRsZWRSZWplY3Rpb24gPSBmdW5jdGlvbiBlbWl0VW5oYW5kbGVkUmVqZWN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGxhdGVzdFRpbWVzdGFtcFRvRW1pdCA9IERhdGUubm93KCkgLSBjb29saW5nT2ZmUGVyaW9kO1xuICAgICAgICAgICAgcG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb25zLmZvckVhY2goZnVuY3Rpb24gKF9yZWYyLCBwcm9taXNlKSB7XG4gICAgICAgICAgICAgIHZhciByZWFzb24gPSBfcmVmMi5yZWFzb24sXG4gICAgICAgICAgICAgICAgdGltZXN0YW1wID0gX3JlZjIudGltZXN0YW1wO1xuICAgICAgICAgICAgICBpZiAodGltZXN0YW1wID4gbGF0ZXN0VGltZXN0YW1wVG9FbWl0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uc1tcImRlbGV0ZVwiXShwcm9taXNlKTtcbiAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dChyZWFzb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoaW50ZXJ2YWxJZCAhPT0gbnVsbCAmJiBwb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbnMuc2l6ZSA9PT0gMCkge1xuICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbChpbnRlcnZhbElkKTtcbiAgICAgICAgICAgICAgaW50ZXJ2YWxJZCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgICB2YXIgcmVnaXN0ZXJQb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbiA9IGZ1bmN0aW9uIHJlZ2lzdGVyUG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBwb3NzaWJseVVuaGFuZGxlZFJlamVjdGlvbnMuc2V0KGV2ZW50LnByb21pc2UsIHtcbiAgICAgICAgICAgICAgcmVhc29uOiBldmVudC5yZWFzb24sXG4gICAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoaW50ZXJ2YWxJZCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICBpbnRlcnZhbElkID0gd2luZG93LnNldEludGVydmFsKGVtaXRVbmhhbmRsZWRSZWplY3Rpb24sIGNvb2xpbmdPZmZQZXJpb2QgLyAyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZWplY3Rpb25oYW5kbGVkJywgZGVsZXRlUG9zc2libHlVbmhhbmRsZWRSZWplY3Rpb24pO1xuICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd1bmhhbmRsZWRyZWplY3Rpb24nLCByZWdpc3RlclBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uKTtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGludGVydmFsSWQgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwoaW50ZXJ2YWxJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVqZWN0aW9uaGFuZGxlZCcsIGRlbGV0ZVBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uKTtcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCd1bmhhbmRsZWRyZWplY3Rpb24nLCByZWdpc3RlclBvc3NpYmx5VW5oYW5kbGVkUmVqZWN0aW9uKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIG93bktleXMoZSwgcikgeyB2YXIgdCA9IE9iamVjdC5rZXlzKGUpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgbyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7IHIgJiYgKG8gPSBvLmZpbHRlcihmdW5jdGlvbiAocikgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLCByKS5lbnVtZXJhYmxlOyB9KSksIHQucHVzaC5hcHBseSh0LCBvKTsgfSByZXR1cm4gdDsgfVxuICAgIGZ1bmN0aW9uIF9vYmplY3RTcHJlYWQoZSkgeyBmb3IgKHZhciByID0gMTsgciA8IGFyZ3VtZW50cy5sZW5ndGg7IHIrKykgeyB2YXIgdCA9IG51bGwgIT0gYXJndW1lbnRzW3JdID8gYXJndW1lbnRzW3JdIDoge307IHIgJSAyID8gb3duS2V5cyhPYmplY3QodCksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKHIpIHsgX2RlZmluZVByb3BlcnR5KGUsIHIsIHRbcl0pOyB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnModCkpIDogb3duS2V5cyhPYmplY3QodCkpLmZvckVhY2goZnVuY3Rpb24gKHIpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsIHIsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCwgcikpOyB9KTsgfSByZXR1cm4gZTsgfVxuICAgIHZhciBjcmVhdGVWaWRlb0ZyYW1lID0gZnVuY3Rpb24gY3JlYXRlVmlkZW9GcmFtZShlbWl0Tm90U3VwcG9ydGVkRXJyb3IsIHdyYXBTdWJzY3JpYmVGdW5jdGlvbikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uICh2aWRlb0VsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHdyYXBTdWJzY3JpYmVGdW5jdGlvbihmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICBpZiAodmlkZW9FbGVtZW50LmNhbmNlbFZpZGVvRnJhbWVDYWxsYmFjayA9PT0gdW5kZWZpbmVkIHx8IHZpZGVvRWxlbWVudC5yZXF1ZXN0VmlkZW9GcmFtZUNhbGxiYWNrID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBlbWl0Tm90U3VwcG9ydGVkRXJyb3Iob2JzZXJ2ZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgdmlkZW9GcmFtZUhhbmRsZSA9IHZpZGVvRWxlbWVudC5yZXF1ZXN0VmlkZW9GcmFtZUNhbGxiYWNrKGZ1bmN0aW9uIHZpZGVvRnJhbWVDYWxsYmFjayhub3csIG1ldGFkYXRhKSB7XG4gICAgICAgICAgICB2aWRlb0ZyYW1lSGFuZGxlID0gdmlkZW9FbGVtZW50LnJlcXVlc3RWaWRlb0ZyYW1lQ2FsbGJhY2sodmlkZW9GcmFtZUNhbGxiYWNrKTtcbiAgICAgICAgICAgIG9ic2VydmVyLm5leHQoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBtZXRhZGF0YSksIHt9LCB7XG4gICAgICAgICAgICAgIG5vdzogbm93XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB2aWRlb0VsZW1lbnQuY2FuY2VsVmlkZW9GcmFtZUNhbGxiYWNrKHZpZGVvRnJhbWVIYW5kbGUpO1xuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9O1xuXG4gICAgdmFyIGNyZWF0ZVdha2VMb2NrID0gZnVuY3Rpb24gY3JlYXRlV2FrZUxvY2soZW1pdE5vdFN1cHBvcnRlZEVycm9yLCB3aW5kb3csIHdyYXBTdWJzY3JpYmVGdW5jdGlvbikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIHJldHVybiB3cmFwU3Vic2NyaWJlRnVuY3Rpb24oZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgICAgaWYgKHdpbmRvdyA9PT0gbnVsbCB8fCB3aW5kb3cubmF2aWdhdG9yID09PSB1bmRlZmluZWQgfHwgd2luZG93Lm5hdmlnYXRvci53YWtlTG9jayA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gZW1pdE5vdFN1cHBvcnRlZEVycm9yKG9ic2VydmVyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHJlbGVhc2VXYWtlTG9jayA9IGZ1bmN0aW9uIHJlbGVhc2VXYWtlTG9jayh3YWtlTG9ja1NlbnRpbmVsKSB7XG4gICAgICAgICAgICByZXR1cm4gd2FrZUxvY2tTZW50aW5lbC5yZWxlYXNlKClbXCJjYXRjaFwiXShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIC8vIElnbm9yZSBlcnJvcnMuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIHZhciByZW1vdmVSZWxlYXNlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIHJlbW92ZVJlbGVhc2VFdmVudExpc3RlbmVyKHdha2VMb2NrU2VudGluZWwpIHtcbiAgICAgICAgICAgIHdha2VMb2NrU2VudGluZWwub25yZWxlYXNlID0gbnVsbDtcbiAgICAgICAgICB9O1xuICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgdmFyIHVuc3Vic2NyaWJlV2hpbGVSZXF1ZXN0aW5nID0gZnVuY3Rpb24gdW5zdWJzY3JpYmVXaGlsZVJlcXVlc3RpbmcoKSB7XG4gICAgICAgICAgICBpc0FjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgIH07XG4gICAgICAgICAgdmFyIHVuc3Vic2NyaWJlID0gdW5zdWJzY3JpYmVXaGlsZVJlcXVlc3Rpbmc7XG4gICAgICAgICAgdmFyIF9yZXF1ZXN0V2FrZUxvY2sgPSBmdW5jdGlvbiByZXF1ZXN0V2FrZUxvY2soKSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93Lm5hdmlnYXRvci53YWtlTG9jay5yZXF1ZXN0KHR5cGUpLnRoZW4oZnVuY3Rpb24gKHdha2VMb2NrU2VudGluZWwpIHtcbiAgICAgICAgICAgICAgaWYgKGlzQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dCh0cnVlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpZiAoaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICB3YWtlTG9ja1NlbnRpbmVsLm9ucmVsZWFzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgdW5zdWJzY3JpYmUgPSB1bnN1YnNjcmliZVdoaWxlUmVxdWVzdGluZztcbiAgICAgICAgICAgICAgICAgIHJlbW92ZVJlbGVhc2VFdmVudExpc3RlbmVyKHdha2VMb2NrU2VudGluZWwpO1xuICAgICAgICAgICAgICAgICAgX3JlcXVlc3RXYWtlTG9jaygpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdW5zdWJzY3JpYmUgPSBmdW5jdGlvbiB1bnN1YnNjcmliZSgpIHtcbiAgICAgICAgICAgICAgICAgIHJlbW92ZVJlbGVhc2VFdmVudExpc3RlbmVyKHdha2VMb2NrU2VudGluZWwpO1xuICAgICAgICAgICAgICAgICAgcmVsZWFzZVdha2VMb2NrKHdha2VMb2NrU2VudGluZWwpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVsZWFzZVdha2VMb2NrKHdha2VMb2NrU2VudGluZWwpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgIGlmIChpc0FjdGl2ZSkge1xuICAgICAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKGVycik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH07XG4gICAgICAgICAgX3JlcXVlc3RXYWtlTG9jaygpO1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfTtcblxuICAgIC8vIEB0b2RvIFR5cGVTY3JpcHQgZG9lcyBub3QgaW5jbHVkZSB0eXBlIGRlZmluaXRpb25zIGZvciB0aGUgUmVwb3J0aW5nIEFQSSB5ZXQuXG4gICAgdmFyIGNyZWF0ZVdpbmRvdyA9IGZ1bmN0aW9uIGNyZWF0ZVdpbmRvdygpIHtcbiAgICAgIHJldHVybiB0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyA/IG51bGwgOiB3aW5kb3c7XG4gICAgfTtcblxuICAgIHZhciBjcmVhdGVXcmFwU3Vic2NyaWJlRnVuY3Rpb24gPSBmdW5jdGlvbiBjcmVhdGVXcmFwU3Vic2NyaWJlRnVuY3Rpb24ocGF0Y2gsIHRvT2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBlbXB0eUZ1bmN0aW9uID0gZnVuY3Rpb24gZW1wdHlGdW5jdGlvbigpIHt9OyAvLyB0c2xpbnQ6ZGlzYWJsZS1saW5lOm5vLWVtcHR5XG4gICAgICB2YXIgaXNOZXh0RnVuY3Rpb24gPSBmdW5jdGlvbiBpc05leHRGdW5jdGlvbihhcmdzKSB7XG4gICAgICAgIHJldHVybiB0eXBlb2YgYXJnc1swXSA9PT0gJ2Z1bmN0aW9uJztcbiAgICAgIH07XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKGlubmVyU3Vic2NyaWJlKSB7XG4gICAgICAgIHZhciBfc3Vic2NyaWJlID0gZnVuY3Rpb24gc3Vic2NyaWJlKCkge1xuICAgICAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgICAgICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHVuc3Vic2NyaWJlID0gaW5uZXJTdWJzY3JpYmUoaXNOZXh0RnVuY3Rpb24oYXJncykgPyB0b09ic2VydmVyKHtcbiAgICAgICAgICAgIG5leHQ6IGFyZ3NbMF1cbiAgICAgICAgICB9KSA6IHRvT2JzZXJ2ZXIuYXBwbHkodm9pZCAwLCBhcmdzKSk7XG4gICAgICAgICAgaWYgKHVuc3Vic2NyaWJlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB1bnN1YnNjcmliZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGVtcHR5RnVuY3Rpb247XG4gICAgICAgIH07XG4gICAgICAgIF9zdWJzY3JpYmVbU3ltYm9sLm9ic2VydmFibGVdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdWJzY3JpYmU6IGZ1bmN0aW9uIHN1YnNjcmliZSgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB1bnN1YnNjcmliZTogX3N1YnNjcmliZS5hcHBseSh2b2lkIDAsIGFyZ3VtZW50cylcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gcGF0Y2goX3N1YnNjcmliZSk7XG4gICAgICB9O1xuICAgIH07XG5cbiAgICB2YXIgZW1pdE5vdFN1cHBvcnRlZEVycm9yID0gZnVuY3Rpb24gZW1pdE5vdFN1cHBvcnRlZEVycm9yKG9ic2VydmVyKSB7XG4gICAgICBvYnNlcnZlci5lcnJvcihuZXcgRXJyb3IoJ1RoZSByZXF1aXJlZCBicm93c2VyIEFQSSBzZWVtcyB0byBiZSBub3Qgc3VwcG9ydGVkLicpKTtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7fTsgLy8gdHNsaW50OmRpc2FibGUtbGluZTpuby1lbXB0eVxuICAgIH07XG5cbiAgICB2YXIgd2luZG93JDEgPSBjcmVhdGVXaW5kb3coKTtcbiAgICB2YXIgd3JhcFN1YnNjcmliZUZ1bmN0aW9uID0gY3JlYXRlV3JhcFN1YnNjcmliZUZ1bmN0aW9uKHJ4anNJbnRlcm9wLnBhdGNoLCByeGpzSW50ZXJvcC50b09ic2VydmVyKTtcbiAgICB2YXIgYW5pbWF0aW9uRnJhbWUgPSBjcmVhdGVBbmltYXRpb25GcmFtZShlbWl0Tm90U3VwcG9ydGVkRXJyb3IsIHdpbmRvdyQxLCB3cmFwU3Vic2NyaWJlRnVuY3Rpb24pO1xuICAgIHZhciBtdXRhdGlvbnMgPSBjcmVhdGVNdXRhdGlvbnMoZW1pdE5vdFN1cHBvcnRlZEVycm9yLCB3aW5kb3ckMSwgd3JhcFN1YnNjcmliZUZ1bmN0aW9uKTtcbiAgICB2YXIgbWFwU3Vic2NyaWJhYmxlVGhpbmcgPSBjcmVhdGVNYXBTdWJzY3JpYmFibGVUaGluZyh3cmFwU3Vic2NyaWJlRnVuY3Rpb24pO1xuICAgIHZhciBwcmVwZW5kU3Vic2NyaWJhYmxlVGhpbmcgPSBjcmVhdGVQcmVwZW5kU3Vic2NyaWJhYmxlVGhpbmcod3JhcFN1YnNjcmliZUZ1bmN0aW9uKTtcbiAgICB2YXIgYXR0cmlidXRlID0gY3JlYXRlQXR0cmlidXRlKG1hcFN1YnNjcmliYWJsZVRoaW5nLCBtdXRhdGlvbnMsIHByZXBlbmRTdWJzY3JpYmFibGVUaGluZyk7XG4gICAgdmFyIGdlb2xvY2F0aW9uID0gY3JlYXRlR2VvbG9jYXRpb24oZW1pdE5vdFN1cHBvcnRlZEVycm9yLCB3aW5kb3ckMSwgd3JhcFN1YnNjcmliZUZ1bmN0aW9uKTtcbiAgICB2YXIgaW50ZXJzZWN0aW9ucyA9IGNyZWF0ZUludGVyc2VjdGlvbnMoZW1pdE5vdFN1cHBvcnRlZEVycm9yLCB3aW5kb3ckMSwgd3JhcFN1YnNjcmliZUZ1bmN0aW9uKTtcbiAgICB2YXIgbWVkaWFEZXZpY2VzID0gY3JlYXRlTWVkaWFEZXZpY2VzKGVtaXROb3RTdXBwb3J0ZWRFcnJvciwgd2luZG93JDEsIHdyYXBTdWJzY3JpYmVGdW5jdGlvbik7XG4gICAgdmFyIG1lZGlhUXVlcnlNYXRjaCA9IGNyZWF0ZU1lZGlhUXVlcnlNYXRjaChlbWl0Tm90U3VwcG9ydGVkRXJyb3IsIHdpbmRvdyQxLCB3cmFwU3Vic2NyaWJlRnVuY3Rpb24pO1xuICAgIHZhciBtZXRyaWNzID0gY3JlYXRlTWV0cmljcyhlbWl0Tm90U3VwcG9ydGVkRXJyb3IsIHdpbmRvdyQxLCB3cmFwU3Vic2NyaWJlRnVuY3Rpb24pO1xuICAgIHZhciBtaWRpSW5wdXRzID0gY3JlYXRlTWlkaUlucHV0cyh3cmFwU3Vic2NyaWJlRnVuY3Rpb24pO1xuICAgIHZhciBtaWRpT3V0cHV0cyA9IGNyZWF0ZU1pZGlPdXRwdXRzKHdyYXBTdWJzY3JpYmVGdW5jdGlvbik7XG4gICAgdmFyIG9uID0gY3JlYXRlT24od3JhcFN1YnNjcmliZUZ1bmN0aW9uKTtcbiAgICB2YXIgb25saW5lID0gY3JlYXRlT25saW5lKGVtaXROb3RTdXBwb3J0ZWRFcnJvciwgd2luZG93JDEsIHdyYXBTdWJzY3JpYmVGdW5jdGlvbik7XG4gICAgdmFyIHBlcm1pc3Npb25TdGF0ZSA9IGNyZWF0ZVBlcm1pc3Npb25TdGF0ZShlbWl0Tm90U3VwcG9ydGVkRXJyb3IsIHdpbmRvdyQxLCB3cmFwU3Vic2NyaWJlRnVuY3Rpb24pO1xuICAgIHZhciByZXBvcnRzID0gY3JlYXRlUmVwb3J0cyhlbWl0Tm90U3VwcG9ydGVkRXJyb3IsIHdpbmRvdyQxLCB3cmFwU3Vic2NyaWJlRnVuY3Rpb24pO1xuICAgIHZhciByZXNpemVzID0gY3JlYXRlUmVzaXplcyhlbWl0Tm90U3VwcG9ydGVkRXJyb3IsIHdpbmRvdyQxLCB3cmFwU3Vic2NyaWJlRnVuY3Rpb24pO1xuICAgIHZhciB1bmhhbmRsZWRSZWplY3Rpb24gPSBjcmVhdGVVbmhhbmRsZWRSZWplY3Rpb24oZW1pdE5vdFN1cHBvcnRlZEVycm9yLCB3aW5kb3ckMSwgd3JhcFN1YnNjcmliZUZ1bmN0aW9uKTtcbiAgICB2YXIgdmlkZW9GcmFtZSA9IGNyZWF0ZVZpZGVvRnJhbWUoZW1pdE5vdFN1cHBvcnRlZEVycm9yLCB3cmFwU3Vic2NyaWJlRnVuY3Rpb24pO1xuICAgIHZhciB3YWtlTG9jayA9IGNyZWF0ZVdha2VMb2NrKGVtaXROb3RTdXBwb3J0ZWRFcnJvciwgd2luZG93JDEsIHdyYXBTdWJzY3JpYmVGdW5jdGlvbik7XG5cbiAgICBleHBvcnRzLmFuaW1hdGlvbkZyYW1lID0gYW5pbWF0aW9uRnJhbWU7XG4gICAgZXhwb3J0cy5hdHRyaWJ1dGUgPSBhdHRyaWJ1dGU7XG4gICAgZXhwb3J0cy5nZW9sb2NhdGlvbiA9IGdlb2xvY2F0aW9uO1xuICAgIGV4cG9ydHMuaW50ZXJzZWN0aW9ucyA9IGludGVyc2VjdGlvbnM7XG4gICAgZXhwb3J0cy5tZWRpYURldmljZXMgPSBtZWRpYURldmljZXM7XG4gICAgZXhwb3J0cy5tZWRpYVF1ZXJ5TWF0Y2ggPSBtZWRpYVF1ZXJ5TWF0Y2g7XG4gICAgZXhwb3J0cy5tZXRyaWNzID0gbWV0cmljcztcbiAgICBleHBvcnRzLm1pZGlJbnB1dHMgPSBtaWRpSW5wdXRzO1xuICAgIGV4cG9ydHMubWlkaU91dHB1dHMgPSBtaWRpT3V0cHV0cztcbiAgICBleHBvcnRzLm11dGF0aW9ucyA9IG11dGF0aW9ucztcbiAgICBleHBvcnRzLm9uID0gb247XG4gICAgZXhwb3J0cy5vbmxpbmUgPSBvbmxpbmU7XG4gICAgZXhwb3J0cy5wZXJtaXNzaW9uU3RhdGUgPSBwZXJtaXNzaW9uU3RhdGU7XG4gICAgZXhwb3J0cy5yZXBvcnRzID0gcmVwb3J0cztcbiAgICBleHBvcnRzLnJlc2l6ZXMgPSByZXNpemVzO1xuICAgIGV4cG9ydHMudW5oYW5kbGVkUmVqZWN0aW9uID0gdW5oYW5kbGVkUmVqZWN0aW9uO1xuICAgIGV4cG9ydHMudmlkZW9GcmFtZSA9IHZpZGVvRnJhbWU7XG4gICAgZXhwb3J0cy53YWtlTG9jayA9IHdha2VMb2NrO1xuXG59KSk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/subscribable-things/build/es5/bundle.js\n");

/***/ })

};
;